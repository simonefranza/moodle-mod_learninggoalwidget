define(["jquery","mod_learninggoalwidget/controller","mod_learninggoalwidget/treemap_module","core/config"],function(l,u,i,d){const o=(a,r,n,t)=>{require(["d3v7"],e=>{i.setupTreemap(a,e,r,n,t,(e,a,r)=>{s(g(e),c(e),m(e),p(e),v(e),a.parent.data.topicid,a.data.goalid,a.data.name,r)}),i.setupSvg()})},s=(a,e,r,n,t,i,d,o,s)=>{u.updateUserProgress({courseid:e,coursemoduleid:r,instanceid:n,userid:t,topicid:i,goalid:d,progress:s}).then(e=>{var e=JSON.parse(e);0!==e.children.length&&(e=new CustomEvent("update_learning_goal_progress",{bubbles:!0,detail:{sender:"treemap",taxonomy:e,treemapId:a}}),l("#"+a)[0].dispatchEvent(e))}).catch(()=>{});i=((e,a,r,n)=>{const t={name:"courseid",value:e},i={name:"coursemoduleid",value:a},d={name:"instanceid",value:r},o={name:"userid",value:n},s={name:"timestamp",value:Math.trunc((new Date).getTime()/1e3)};return[t,i,d,o,s]})("preparationSaveProgress",e,r,n),d={name:"goalprogress",value:s};i.push({name:"goalname",value:o}),i.push(d),u.logEvent({courseid:e,coursemoduleid:r,instanceid:n,userid:t,eventparams:i})},g=e=>{e=l(e).closest("div.learninggoalwidget");return l(e).data("treemap-id")},c=e=>{e=l(e).closest("div.learninggoalwidget");return l(e).data("course-id")},m=e=>{e=l(e).closest("div.learninggoalwidget");return l(e).data("coursemodule-id")},p=e=>{e=l(e).closest("div.learninggoalwidget");return l(e).data("instance-id")},v=e=>{e=l(e).closest("div.learninggoalwidget");return l(e).data("user-id")};return{renderTreemap:(a,e,r,n,t,i)=>{require.config({paths:{d3v7:d.wwwroot+"/mod/learninggoalwidget/js/d3.v7.min"}}),u.getLearningGoals({courseid:r,userid:e,coursemoduleid:n,instanceid:t}).then(e=>{e=JSON.parse(e);0<e.children.length&&o(e,a,i,!0)}).catch(()=>{})},renderTreemapView:o}});
//# sourceMappingURL=treemap.min.js.map