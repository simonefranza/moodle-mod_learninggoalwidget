{"version":3,"file":"view.min.js","sources":["../src/view.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @copyright University of Technology Graz\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint no-eval: 0 */\n/* eslint no-bitwise: 0 */\n/* eslint \"require-jsdoc\": [\"error\", {\n    \"require\": {\n        \"FunctionDeclaration\": false,\n        \"MethodDefinition\": false,\n        \"ClassDeclaration\": false,\n        \"ArrowFunctionExpression\": false,\n        \"FunctionExpression\": false\n    }\n}] */\n\ndefine(\n    [\n        \"jquery\",\n        \"mod_learninggoalwidget/sunburst\",\n        \"mod_learninggoalwidget/treemap\"\n    ], function (\n        $,\n        Sunburst,\n        Treemap\n    ) {\n\n    /**\n     * Intialise the widget and its content and exam views.\n     *\n     * @param {object} root The root element of the learning goals widget.\n     */\n    var initViews = function (root) {\n\n        // console.log(\"mod_learninggoalwidget.view> Init Views of Learning Goals Widget\");\n\n        root = $(root);\n\n        Sunburst.renderSunburst(root.data(\"sunburst-id\"),\n            root.data(\"user-id\"),\n            root.data(\"course-id\"),\n            root.data(\"coursemodule-id\"),\n            root.data(\"instance-id\"),\n            root.attr(\"data-progresslegendLabel\"));\n\n        Treemap.renderTreemap(root.data(\"treemap-id\"),\n            root.data(\"user-id\"),\n            root.data(\"course-id\"),\n            root.data(\"coursemodule-id\"),\n            root.data(\"instance-id\"),\n            root.attr(\"data-treemapAccessibilityText\"));\n\n        document.getElementById(root.data(\"course-id\") + \"-\"\n            + root.data(\"coursemodule-id\") + \"-\"\n            + root.data(\"instance-id\")\n            + \"-treemap-thumbnail\").onclick = function () {\n                $(\"#\" + root.data(\"treemap-id\") + \"-container\").removeClass(\"d-none\");\n                $(\"#\" + root.data(\"treemap-id\")).empty();\n                Treemap.renderTreemap(root.data(\"treemap-id\"),\n                    root.data(\"user-id\"),\n                    root.data(\"course-id\"),\n                    root.data(\"coursemodule-id\"),\n                    root.data(\"instance-id\"),\n                    root.attr(\"data-treemapAccessibilityText\"));\n                $(\"#\" + root.data(\"sunburst-id\") + \"-container\").addClass(\"d-none\");\n            };\n\n        document.getElementById(root.data(\"course-id\") + \"-\" + root.data(\"coursemodule-id\") + \"-\"\n            + root.data(\"instance-id\")\n            + \"-sunburst-thumbnail\").onclick = function () {\n                $(\"#\" + root.data(\"treemap-id\") + \"-container\").addClass(\"d-none\");\n                $(\"#\" + root.data(\"sunburst-id\") + \"-container\").removeClass(\"d-none\");\n            };\n\n        $(\"#\" + root.data(\"treemap-id\") + \"-container\").addClass(\"d-none\");\n        $(\"#\" + root.data(\"sunburst-id\") + \"-container\").removeClass(\"d-none\");\n\n        // update visualisations whenever a learning goal's progress changes\n        root.on(\"update_learning_goal_progress\", function (updateLearningGoalProgressEvent) {\n            // console.log(\"mod_learninggoalwidget.view> Received update learning goal progress event\");\n            // console.log(updateLearningGoalProgressEvent.detail);\n            // console.log(\"new progress value: \");\n            // console.log(updateLearningGoalProgressEvent.detail.goalProgressValue);\n            if (updateLearningGoalProgressEvent.detail.sender === \"sunburst\") {\n                // console.log(\"mod_learninggoalwidget.view> sender = sunburst\");\n                $(\"#\" + root.data(\"treemap-id\")).empty();\n                Treemap.renderTreemapView(\n                    updateLearningGoalProgressEvent.detail.taxonomy,\n                    root.data(\"treemap-id\"),\n                    root.attr(\"data-treemapAccessibilityText\"));\n                // console.log(\"mod_learninggoalwidget.view> treemap updated\");\n            }\n            if (updateLearningGoalProgressEvent.detail.sender === \"treemap\") {\n                // console.log(\"mod_learninggoalwidget.view> sender = treemap\");\n                $(\"div#\" + root.data(\"sunburst-id\") + \"-taxonomy-userprogress-chart-fullgoal\").remove();\n                $(\"#\" + root.data(\"sunburst-id\") + \"-taxonomy-userprogress-chart\").empty();\n                $(\"#\" + root.data(\"sunburst-id\") + \"-taxonomy-userprogress-legend\").empty();\n                Sunburst.renderSunburstWithProgressView(\n                    updateLearningGoalProgressEvent.detail.taxonomy,\n                    root.data(\"sunburst-id\"),\n                    root.attr(\"data-progresslegendLabel\"));\n                // console.log(\"mod_learninggoalwidget.view> sunburst updated\");\n            }\n        });\n    };\n\n    return {\n        initViews: initViews\n    };\n}\n);\n"],"names":["define","$","Sunburst","Treemap","initViews","root","renderSunburst","data","attr","renderTreemap","document","getElementById","onclick","removeClass","empty","addClass","on","updateLearningGoalProgressEvent","detail","sender","renderTreemapView","taxonomy","remove","renderSunburstWithProgressView"],"mappings":";;;;AAgCAA,qCACI,CACI,SACA,kCACA,mCACD,SACCC,EACAC,SACAC,eAkFG,CACHC,UA3EY,SAAUC,MAItBA,KAAOJ,EAAEI,MAETH,SAASI,eAAeD,KAAKE,KAAK,eAC9BF,KAAKE,KAAK,WACVF,KAAKE,KAAK,aACVF,KAAKE,KAAK,mBACVF,KAAKE,KAAK,eACVF,KAAKG,KAAK,6BAEdL,QAAQM,cAAcJ,KAAKE,KAAK,cAC5BF,KAAKE,KAAK,WACVF,KAAKE,KAAK,aACVF,KAAKE,KAAK,mBACVF,KAAKE,KAAK,eACVF,KAAKG,KAAK,kCAEdE,SAASC,eAAeN,KAAKE,KAAK,aAAe,IAC3CF,KAAKE,KAAK,mBAAqB,IAC/BF,KAAKE,KAAK,eACV,sBAAsBK,QAAU,WAC9BX,EAAE,IAAMI,KAAKE,KAAK,cAAgB,cAAcM,YAAY,UAC5DZ,EAAE,IAAMI,KAAKE,KAAK,eAAeO,QACjCX,QAAQM,cAAcJ,KAAKE,KAAK,cAC5BF,KAAKE,KAAK,WACVF,KAAKE,KAAK,aACVF,KAAKE,KAAK,mBACVF,KAAKE,KAAK,eACVF,KAAKG,KAAK,kCACdP,EAAE,IAAMI,KAAKE,KAAK,eAAiB,cAAcQ,SAAS,WAGlEL,SAASC,eAAeN,KAAKE,KAAK,aAAe,IAAMF,KAAKE,KAAK,mBAAqB,IAChFF,KAAKE,KAAK,eACV,uBAAuBK,QAAU,WAC/BX,EAAE,IAAMI,KAAKE,KAAK,cAAgB,cAAcQ,SAAS,UACzDd,EAAE,IAAMI,KAAKE,KAAK,eAAiB,cAAcM,YAAY,WAGrEZ,EAAE,IAAMI,KAAKE,KAAK,cAAgB,cAAcQ,SAAS,UACzDd,EAAE,IAAMI,KAAKE,KAAK,eAAiB,cAAcM,YAAY,UAG7DR,KAAKW,GAAG,iCAAiC,SAAUC,iCAKO,aAAlDA,gCAAgCC,OAAOC,SAEvClB,EAAE,IAAMI,KAAKE,KAAK,eAAeO,QACjCX,QAAQiB,kBACJH,gCAAgCC,OAAOG,SACvChB,KAAKE,KAAK,cACVF,KAAKG,KAAK,mCAGoC,YAAlDS,gCAAgCC,OAAOC,SAEvClB,EAAE,OAASI,KAAKE,KAAK,eAAiB,yCAAyCe,SAC/ErB,EAAE,IAAMI,KAAKE,KAAK,eAAiB,gCAAgCO,QACnEb,EAAE,IAAMI,KAAKE,KAAK,eAAiB,iCAAiCO,QACpEZ,SAASqB,+BACLN,gCAAgCC,OAAOG,SACvChB,KAAKE,KAAK,eACVF,KAAKG,KAAK"}